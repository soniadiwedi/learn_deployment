<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Home Page</title>
    <style>
      /* Write all necessery css here  */

      .nav{
        
        display: inline;
        display: flex;

      }#product-container{
        display: grid;
        grid-template-columns: repeat(4,1fr);
        
      }#product-containe>div{
        box-shadow: rgba(0, 0, 0, 0.15) 1.95px 1.95px 2.6px;
        gap: 20px 10px ;
      }
      img{
        width: 40%;
      }
    </style>
  </head>

  <body>
    <div class="nav">
      <h1>Masai E-Commerce</h1>
      <a href="./index.html">Home</a>
      <a href="./cart.html">Cart</a>
    </div>
    <!-- Use this Select Tag for Filtering the Products  -->
    <select id="filter">
      <option value="">Filter By Category</option>
      <option value="Laptop">Laptop</option>
      <option value="Mobile">Mobile</option>
      <option value="Speakers">Speakers</option>
    </select>
    <div id="product-container">
      <!-- Here Append All the Products  -->
    </div>
  </body>
  <script>
      // Write all necessery JS here 
      let filtering=document.querySelector("#filter");
      filtering.addEventListener("change",filterdata);
//--------------------------------------------------------------------

      


    let url="https://dbioz2ek0e.execute-api.ap-south-1.amazonaws.com/mockapi/get-tech-products"
    let cards=null;

    async function FetchData(){
      try{
        let res= await fetch(url);
        let out=await res.json()
        cards=await out.data
        displayData(cards)
        console.log(cards)
      }catch(err){
        alert(err)
      }
    }

    
    //------------------------------
    function displayData(alldata){
        document.querySelector("#product-container").innerHTML="";

        alldata.forEach((elem,index)=>{

          let div=document.createElement("div");

          let image_tag=document.createElement("img");
          image_tag.src=elem.img;

          let title=document.createElement("h5")
          title.innerText=elem.brand;

          let price=document.createElement("h6")
          price.innerText="Rs"+elem.price;

          let details=document.createElement("p")
          details.innerText=elem.details;

          let category=document.createElement("p")
          category.innerText=elem.category;

          let btn=document.createElement("button")
          btn.innerText="Add To Cart"
          btn.addEventListener("click",function(){
            Addingcard(elem);
          })

          div.append(image_tag,title,price,details,category,btn);
          document.querySelector("#product-container").append(div);
        })
    }

//--------

 function filterdata(event){
  let val=event.target.value;
  if(val==""){
    FetchData()
  }else{
    let filter_data=cards.filter((element)=>element.category===val)
  displayData(filter_data)
 
  }
  
 }


  function Addingcard(elem){

    let lsdata=JSON.parse(localStorage.getItem("cart"))||[];
    let flag="no"
    for(let i=0;i<lsdata.length;i++){
      if(elem.id==lsdata[i].id){
        flag="yes"
        break;
      }
    }
    if(flag=="yes"){
      alert("Product Already in Cart")
    }else{
      lsdata.push(elem);
    localStorage.setItem("cart",JSON.stringify(lsdata))
    alert("Product Added To Cart")
    }
    
  }
  
  
  FetchData()
  </script>
</html>
